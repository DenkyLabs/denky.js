<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Adding meta -->
    
    
    <meta name="og:site_name" content="peachy.js Documentation" />
    
    <meta name="og:title" content="peachy.js" />
    
    <meta name="description" content="A minimalist and perfomance-focused library in development designed to interact with Discord API." />
    
    <meta name="og:description" content="A minimalist and perfomance-focused library in development designed to interact with Discord API." />
    
    <meta name="theme-color" content="#808080" />
    
    

    <!-- Adding external script-->
    

    <!-- Adding external style-->
    

    <!-- Adding scripts-->
    

    <!-- Adding style-->
    

    <!-- Adding overlay script-->
    

    <!-- Adding overlay style-->
    


    <title>
      client/Client.js
    </title>

    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/third-party/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/third-party/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/reset.css">
    <link type="text/css" rel="stylesheet" href="styles/clean-jsdoc-theme-base.css">
    <link type="text/css" rel="stylesheet" href="styles/clean-jsdoc-theme-dark.css">
    
    <svg aria-hidden="true" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
    style="display:none">
    <defs>
        <symbol id="copy-icon" viewbox="0 0 488.3 488.3">
            <g>
                <path
                    d="M314.25,85.4h-227c-21.3,0-38.6,17.3-38.6,38.6v325.7c0,21.3,17.3,38.6,38.6,38.6h227c21.3,0,38.6-17.3,38.6-38.6V124    C352.75,102.7,335.45,85.4,314.25,85.4z M325.75,449.6c0,6.4-5.2,11.6-11.6,11.6h-227c-6.4,0-11.6-5.2-11.6-11.6V124    c0-6.4,5.2-11.6,11.6-11.6h227c6.4,0,11.6,5.2,11.6,11.6V449.6z" />
                <path
                    d="M401.05,0h-227c-21.3,0-38.6,17.3-38.6,38.6c0,7.5,6,13.5,13.5,13.5s13.5-6,13.5-13.5c0-6.4,5.2-11.6,11.6-11.6h227    c6.4,0,11.6,5.2,11.6,11.6v325.7c0,6.4-5.2,11.6-11.6,11.6c-7.5,0-13.5,6-13.5,13.5s6,13.5,13.5,13.5c21.3,0,38.6-17.3,38.6-38.6    V38.6C439.65,17.3,422.35,0,401.05,0z" />
            </g>
        </symbol>
        <symbol id='search-icon' viewBox="0 0 512 512">
            <g>
                <g>
                    <path
                        d="M225.474,0C101.151,0,0,101.151,0,225.474c0,124.33,101.151,225.474,225.474,225.474    c124.33,0,225.474-101.144,225.474-225.474C450.948,101.151,349.804,0,225.474,0z M225.474,409.323    c-101.373,0-183.848-82.475-183.848-183.848S124.101,41.626,225.474,41.626s183.848,82.475,183.848,183.848    S326.847,409.323,225.474,409.323z" />
                </g>
            </g>
            <g>
                <g>
                    <path
                        d="M505.902,476.472L386.574,357.144c-8.131-8.131-21.299-8.131-29.43,0c-8.131,8.124-8.131,21.306,0,29.43l119.328,119.328    c4.065,4.065,9.387,6.098,14.715,6.098c5.321,0,10.649-2.033,14.715-6.098C514.033,497.778,514.033,484.596,505.902,476.472z" />
                </g>
            </g>
        </symbol>
        <symbol id="down-icon" viewBox="0 0 16 16">
            <path 
                fill-rule="evenodd" 
                clip-rule="evenodd" 
                d="M12.7803 6.21967C13.0732 6.51256 13.0732 6.98744 12.7803 7.28033L8.53033 11.5303C8.23744 11.8232 7.76256 11.8232 7.46967 11.5303L3.21967 7.28033C2.92678 6.98744 2.92678 6.51256 3.21967 6.21967C3.51256 5.92678 3.98744 5.92678 4.28033 6.21967L8 9.93934L11.7197 6.21967C12.0126 5.92678 12.4874 5.92678 12.7803 6.21967Z"
            >
            </path>
        </symbol>
    </defs>
</svg>
  </head>

  <body>

    <nav class="navbar" id="navbar">
      <div class="navbar-heading" id="navbar-heading"><a href="index.html"><h2 class="navbar-heading-text">peachy.js</h2></a></div><div class="search-box" id="search-box"><div class="search-box-input-container"><input class="search-box-input" type="text" placeholder="Search..." id="search-box-input" /><svg class="search-icon" alt="search-icon"><use xlink:href="#search-icon"></use></svg></div><div class="search-item-container" id="search-item-container"><ul class="search-item-ul" id="search-item-ul"></ul></div></div><div class="sidebar-main-content" id="sidebar-main-content"><ul><li class="menu-li"><a href='https://github.com/denkylabs/peachy.js' class=' menu-link' id='' target='_blank'>GitHub</a></li><li class="menu-li"><a href='https://discord.gg/' class=' menu-link' id='' target='_blank'>Support</a></li></ul><div class="accordion collapsed" id="5294805" > <h3 class="accordion-heading">Classes<svg><use xlink:href="#down-icon"></use></svg></h3><ul class="accordion-content"><li class="accordion collapsed child" id=4403660><div class="accordion-heading child"><a href="Client.html">Client</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="Client.html#disconnect">disconnect</a></li><li data-type='method'><a href="Client.html#login">login</a></li></ul></li><li class="accordion collapsed child" id=3546559><div class="accordion-heading child"><a href="Intents.html">Intents</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="Intents.html#.parse">parse</a></li></ul></li><li class="accordion collapsed child" id=4486563><div class="accordion-heading child"><a href="LimitedMap.html">LimitedMap</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="LimitedMap.html#keyArray">keyArray</a></li><li data-type='method'><a href="LimitedMap.html#random">random</a></li><li data-type='method'><a href="LimitedMap.html#valueArray">valueArray</a></li></ul></li><li class="accordion collapsed child" id=428445><div class="accordion-heading child"><a href="Permissions.html">Permissions</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="Permissions.html#.parse">parse</a></li></ul></li></ul> </div><div class="accordion collapsed" id="6616252" > <h3 class="accordion-heading">Events<svg><use xlink:href="#down-icon"></use></svg></h3><ul class="accordion-content"><li class="accordion-list" id=""><a href="Client.html#event:debug">debug</a></li></ul> </div></div>
      

    </nav>
    <div class="navbar-ham" id="navbar-ham">
      <div>
        <div class="first"></div>
        <div class="second"></div>
        <div class="third"></div>
      </div>
    </div>

    <div id="main" class="main-content">
      
      <h1 id='page-title' class="page-title">
        client/Client.js
      </h1>
      

      



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';

const EventEmitter = require('node:events');

const Heartbeater = require('./ws/Heartbeater');

const WebsocketManager = require('./ws/WebsocketManager');
const ActionManager = require('../actions/ActionManager');
const CacheFactory = require('../utils/CacheFactory');
const Intents = require('../utils/Intents');

/**
 * Represents the main peachy.js Client, used for interacting with the Discord API
 * @param {Object} options - Additional client options
 * @param {boolean} [options.autoReconnect=true] - If the client should try to reconnect automatically
 * @param {Array&lt;string>} [options.disabledEvents=[]] - Which events will be disabled and not processed
 * {@link https://github.com/denkylabs/peachy.js/tree/main/src/actions|List of supported events }
 * @param {number} [options.shardId=0] - Shard ID of the client
 * @param {number} [options.shardCount=1] - The total amount of shards used by this client
 * @param {number} [options.apiVersion=9] - The Discord API version to use
 * @param {(Array&lt;string>|number)} [options.intents=['GUILDS']] - The intents to use for the client
 * @param {number} [options.large_threshold=50] - Number of members in a guild after which offline users will no
 * longer be sent in the initial guild member list, must be between 50 and 250
 * @param {boolean} [options.failIfNotExists=false] - Whether to error if the replied message doesn't exists
 * @param {Object} [options.cache] - What will be cached
 * @param {number} options.cache.ChannelManager - How many channels will be cached
 * @param {number} options.cache.ChannelMessageManager - How many messages will be cached
 * @param {number} options.cache.EmojiManager - How many emojis will be cached
 * @param {number} options.cache.GuildChannelManager - How many guild channels will be cached
 * @param {number} options.cache.GuildManager - How many guilds will be cached
 * @param {number} options.cache.GuildMemberManager - How many members will be cached
 * @param {number} options.cache.RoleManager - How many roles will be cached
 * @param {number} options.cache.UserManager - How many users will be cached.
 * @param {Object} [options.allowedMentions] - Default allowed mentions configuration used in messages and interactions
 * @param {Array} options.allowedMentions.parse - Types of mentions to be parsed
 * @param {Array} options.allowedMentions.users - Snowflakes of Users to be parsed as mentions
 * @param {Array} options.allowedMentions.roles - Snowflakes of Roles to be parsed as mentions
 * @param {boolean} options.allowedMentions.replied_user - Whether the author of the Message being replied to should be pinged
 */
class Client extends EventEmitter {
  constructor(options = {}) {
    super();

    this.ready = false;
    this.user = null;
    this.api = {};

    // This will either create the default options or set options that are missing
    this.options = Object.assign(
      {
        autoReconnect: true,
        disabledEvents: [],

        // Data sent in IDENTIFY payload
        shardId: 0,
        shardCount: 1,

        apiVersion: 9,

        intents: ['GUILDS'],
        large_threshold: 50,

        properties: {
          $os: process.platform,
          $browser: 'peachy.js',
          $device: 'peachy.js',
        },

        // By default, all caches are enabled without any limit
        cache: CacheFactory.default(options.cache),

        // Default message options
        failIfNotExists: false,
        allowedMentions: {
          parse: ['users', 'roles', 'everyone'],
          replied_user: true,
          users: [],
          roles: [],
        },
      },
      options,
    );

    // Verify if custom options are valid
    this._verifyOptions();

    // Get bitfield from intent array
    this.options.intents = Intents.parse(this.options.intents);
    this.createManagers();
  }

  createManagers() {
    this.ws = new WebsocketManager(this);
    this.actions = new ActionManager(this);

    CacheFactory.addToClient(this, this.options.cache);
  }

  /**
   * @param {string} token - Logs the client in, establishing a websocket connection to Discord
   */
  login(token = process.env.DISCORD_TOKEN) {
    if (!token) throw new Error('No token provided');

    this.ping = -1;
    this.token = token;

    /**
     * Emitted for general debugging information
     * @event Client#debug
     * @param {string} info - The debug information
     */
    this.emit('debug', '[DEBUG] Login method was called. Preparing to connect to the Discord Gateway.');
    this.ws.connect();
  }

  /**
   * Logs out, terminates the connection to Discord, and destroys the client.
   */
  disconnect() {
    this.ws.connection?.close(1000);
    // Stop heartbeating (this automatically verifies if there's a timer)
    Heartbeater.stop(this);

    this.api = {};
    this.cleanUp();
  }

  cleanUp() {
    this.ping = 1;
    this.ready = false;
    this.user = null;
    this.guilds.cache.clear();
    this.emojis.cache.clear();
    this.users.cache.clear();
    this.channels.cache.clear();
  }

  reconnect() {
    // Stop heartbeating (this automatically verifies if there's a timer)
    Heartbeater.stop(this);

    this.cleanUp();
    this.emit('reconnecting');

    // If we don't have a session id, we cannot reconnect
    this.api.should_resume = Boolean(this.api.sessionId);
    this.login(this.token);
  }

  _verifyOptions() {
    // Type checking
    if (!Array.isArray(this.options.disabledEvents)) throw new Error('The disabledEvents option must be an array.');

    if (typeof this.options.properties !== 'object') throw new Error('The properties option must be an object.');
    if (typeof this.options.cache !== 'object') throw new Error('The cache option must be an object.');

    if (typeof this.options.shardId !== 'number') throw new Error('The shardId option must be a number.');
    if (typeof this.options.apiVersion !== 'number') throw new Error('The apiVersion option must be a number.');
    if (typeof this.options.shardCount !== 'number') throw new Error('The shardCount option must be a number.');
    if (typeof this.options.large_threshold !== 'number') {
      throw new Error('The large_threshold option must be a number.');
    }

    // Value checking
    if (this.options.shardId &lt; 0) throw new Error('The shardId option must be a positive number.');
    if (this.options.shardCount &lt; 1) throw new Error('The shardCount option must be a positive number.');

    if (this.options.large_threshold &lt; 50) {
      throw new Error('The large_threshold option must be a number between 50 and 250.');
    }
    if (this.options.large_threshold > 250) {
      throw new Error('The large_threshold option must be a number between 50 and 250.');
    }
  }
}

module.exports = Client;
</code></pre>
        </article>
    </section>




    </div>

    <footer class="footer" id="footer">
      
    </footer>

    <script src="scripts/third-party/prettify.js"></script>
    <script src="scripts/third-party/lang-css.js"></script>
    <script type="text/javascript" src="scripts/misc.js"></script>

    <script>prettyPrint();</script>
    <script src="scripts/linenumber.js"></script>
    <script src="scripts/fix-code-block.js"></script>
    <script src="scripts/fix-navbar.js"></script>
    
      <script src="scripts/search.js"></script>
      <script src="scripts/third-party/fuse.js"></script>
      <script>
        var list = [{"title":"Client","link":"<a href=\"Client.html\">Client</a>"},{"title":"Client#disconnect","link":"<a href=\"Client.html#disconnect\">Client &rtrif; disconnect</a>"},{"title":"Client#login","link":"<a href=\"Client.html#login\">Client &rtrif; login</a>"},{"title":"Intents","link":"<a href=\"Intents.html\">Intents</a>"},{"title":"Intents.parse","link":"<a href=\"Intents.html#.parse\">Intents.parse &rtrif; undefined</a>"},{"title":"LimitedMap","link":"<a href=\"LimitedMap.html\">LimitedMap</a>"},{"title":"LimitedMap#keyArray","link":"<a href=\"LimitedMap.html#keyArray\">LimitedMap &rtrif; keyArray</a>"},{"title":"LimitedMap#random","link":"<a href=\"LimitedMap.html#random\">LimitedMap &rtrif; random</a>"},{"title":"LimitedMap#valueArray","link":"<a href=\"LimitedMap.html#valueArray\">LimitedMap &rtrif; valueArray</a>"},{"title":"Permissions","link":"<a href=\"Permissions.html\">Permissions</a>"},{"title":"Permissions.parse","link":"<a href=\"Permissions.html#.parse\">Permissions.parse &rtrif; undefined</a>"},{"title":"debug","link":"<a href=\"Client.html#event:debug\">debug</a>"}];
        var options = 
          setupSearch(list, options)
      </script>
    

    

    

    

    


  </body>

</html>
